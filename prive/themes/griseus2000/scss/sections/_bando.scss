/**
 * Section : bando
 */

/**
 * ===============
 * Tous les bandos
 * ===============
 */
[id^=bando] {
  ul {
    @extend .list-none;
  }
}

/**
 * =================
 * Liens d'évitement
 * =================
 */
#bando_liens_rapides {
  display: none;
  a {}
}

/**
 * ==============================
 * Ordonnancement général
 * ==============================
 */
#bando_principal {
  display: flex;
  align-items: center; // vertical
  background-color: white;
  box-shadow: 0 0.15em 0.15em hsla(0, 0%, 0%, 0.066);

  // Menus déroulants
  .deroulant {
    & > li {
      display:flex;
      position: relative;
      z-index: 2;
      align-items: flex-end; // vertical
      margin-right: $bs/4;
      // icone
      > a {
        height:$bs*2;
        font-size: $bs;
        line-height: 1;
        display: inline-block;
        min-width: $bs;
        padding:$bs/2 $bs/2;
        border: 3px solid transparent;
        border-width: 0 0 3px;
        filter: saturate(0%) opacity(75%);
        text-align:center;
        position: relative;
        text-decoration:none;
        &:after {
          font-family: "Icons";
          font-weight: normal;
          content: '\e812';
          position: absolute;
          bottom: -3px;
          left: 50%;
          transform: translateX(-50%);
          line-height: 1;
          font-size:.7rem;
          color: hsl(0, 0%, 80%);
        }
      }
      // actif
      &.actif > a,
      > a:hover,
      > a:focus {
        filter: saturate(100%) opacity(100%);
        border-color: $couleur-theme;
        &:after {
          color: $couleur-theme;
        }
      }
      // sous-menus
      ul {
        display: none; // temp
        position: absolute;
        left: 0;
        bottom: 0;
        transform: translateY(100%);
        min-width: 14em;
        padding: $bs 0;
        background-color: white;
        box-shadow: 0 0.2em 0.2em hsla(0, 0%, 0%, 0.15);
        /* contour du ul pour faciliter le survol à la souris */
        &:before {
          z-index:-1;
          position:absolute;
          top:0;
          left:-2em;
          right:-2em;
          bottom:-2em;
          background-color:transparent;
          /*border:1px solid blue;*/
          content:'';
        }
        /* contour du 2è niveau */
        ul:before {
          top:-2em;
        }
        a {
          display: block;
          padding: $bs/4 $bs;
          &:hover,
          &:focus {
            background-color: _hsl($teinte, $saturation, 95%);
          }
        }
      }
      &.actif,
      /*&:hover,*/
      &:focus {
        > ul {
          display: block;
          li.haschild {
            position: relative;
            > a {
              //text-decoration: underline;
              //text-decoration-color: lighten($couleur-theme, 20);
              //text-decoration-style: dotted;
              @extend .icon-right-open;
              @extend .icon;
              &:before {
                position: absolute;
                top: 50%;
                right: $bs/2;
                transform: translateY(-50%);
              }
            }
            > ul {
              right: 0;
              top: -$bs;
              bottom: initial;
            }
            &.actif {
              > ul {
                display: block;
                transform: translateX(100%);
              }
            }
          }
        }
      }
    }
  }

  // Boutons
  .rapides {
    .bouton {
      a {
        background-position: $bs/2 $bs/2.2;
        background-repeat: no-repeat;
        padding-left: 1.8*$bs;
      }
    }
    &.deroulant ul {
      min-width:16em;
    }
  }

}

#bando_site { order:1; }
#bando_outils { order:2; }
#bando_collaborer { order:3; }
#bando_rechercher { order:4; }
#bando_identite { order:5; }

/**
 * ==============================
 * Infos visiteur, connexion etc.
 * ==============================
 */
#bando_site {
  margin:0 $bs/2 0 $bs;
  .nom_site_spip {
    .voir {
      margin-left: $bs;
    }
  }
}

#bando_rechercher {
  margin-left:$bs/2;
}

#bando_identite {
  margin-left:auto;
  .deroulant .identite {
    > a {
      font-size: 1rem;
    }
    ul {
      left:auto;
      right:0;
    }
  }
}


/**
 * ============================
 * Boutons de créations rapides
 * ============================
 */
#bando_outils {
  display: flex;

  // Plan
  .bando_rubriques {
    .plan_site {
      // icone
      > a {
        @extend .icon-tree;
        @extend .icon;
        img {
          display: none;
        }
      }
      // sous-menus
      ul {
        .toutsite {
          border-bottom: 1px dotted hsla(0, 0%, 0%, 0.2);
        }
      }
    }
  }
}




/**
 * ============================
 * Menu de navigation principal
 * ============================
 *
 * #bando_navigation
 *   .largeur
 *     ul.deroulant
 *       li(.actif)
 *         a#bando1_menu_XXX
 *         ul
 *           li.favori(.actif)
 *           li.non-favori(.actif)
 *
 */
.navigation_avec_icones a[id^=bando1_menu] {
  background-image: none !important;
}
#bando_navigation {
  z-index: 10;
  color: $couleur-neutre-light;
  //background-color: $couleur-neutre-dark;
  background-color: $couleur-theme-darkest;

  ul {
    @extend .list-none;
  }

  .deroulant {
    //@include gridle( row );
    margin-bottom: 0;

    > li {
      //@include gridle( grow );
      //@include gridle( row );
      position: relative;

      // actif
      &:hover,
      &:focus,
      &.actif {
        > a {
          background-color: $couleur-theme-dark;
        }
        // sous-menu
        > ul {
          display: block;
        }
      }

      // liens
      > a {
        @include gridle( grow );
        position: relative;
        padding: $bs*0.5;
        font-weight: 600;
        // hover
        &:hover,
        &:focus {
          color: white;
        }
      }

      // sous-menus
      > ul {
        display: none;
        z-index: 1;
        /*min-width: 100%;*/
        //background-color: lighten($couleur-neutre-dark, 10);
        background-color: $couleur-neutre-light;

        a {
          display: block;
          padding: $bs*0.5;
          color: $couleur-texte;
          // hover
          &:hover,
          &:focus {
           // color: white;
          }
        }
        li:hover,
        li:focus,
        li.actif {
          > a {
            background-color: $couleur-neutre-light-alpha;
          }
        }
      }
    }
  }

  /* Responsive bureaux (voir aussi dans base/_layout.scss */
  @include gridle_state( tablet-up) {
    .largeur {
      padding: 0;
    }
    .deroulant {
      //display: block;
      //flex-direction: column;
      //flex-wrap: nowrap;
      //justify-content: center; // vertical
      //align-content: center; // pour resserer
      margin: 0; // pas besoin de gouttière
      height: 100vh;
      padding-bottom: 5vh; // centrage vertical plus naturel

      // tous les liens
      a {
        //background-repeat: no-repeat;
        //background-position: $bs*0.5 center;
      }

      // --------
      // Niveau 1
      // --------
      > li {
        //flex-grow: 0;
        width: 100%;
        margin: 0; // pas besoin de gouttière

        // Hover & actif
        &:hover,
        &:focus,
        &.actif {
          // Apparition du sous menu
          > ul {
            opacity: 1;
            width: $largeur-menu;
            //display: flex;
            //flex-direction: column;
            //justify-content: center; // vertical
            //align-content: center; // pour resserer
            //align-items: center;
          }
        }

        // liens
        > a {
          display: block;
          padding: $bs $bs*0.75;
          //padding-left: $bs*2; // pour l'icône
          //background-size: $bs auto;
          &:hover,
          &:focus {
            &:before {
              filter: none !important;
              opacity: 1;
            }
          }
          // Icône devant
          &:before {
            content: '';
            display: inline-block;
            vertical-align: middle;
            width: $bs;
            height: $bs;
            margin-right: 0.5em;
            background-size: contain;
            background-position: center center;
            background-repeat: no-repeat;
            opacity: 0.66;
          }
        }

        // --------
        // Niveau 2
        // --------
        > ul {
          /*position: fixed !important;*/
          /*overflow: hidden;*/
          /*top: 0 !important;*/
          position:fixed; // ne pas définir top: pour être relatif au parent
          margin-top:-3 * $bs;
          left: $largeur-menu;
          /*width: 0;*/
          min-width: auto;
          /*height: 100vh;*/
          /*padding-bottom: 5vh;*/ // centrage vertical plus naturel
          transition: opacity 0.2s;
          box-shadow:
            0.25em 0 0.25em rgba(0, 0, 0, 0.15)/*,
            inset 0.1em 0 0.25em rgba(0, 0, 0, 0.2)*/;
          /* contour du ul pour faciliter le survol à la souris */
          &:before {
            z-index:-1;
            position:absolute;
            top:-2em;
            left:0em;
            right:-2em;
            bottom:-2em;
            background-color:transparent;
            /*border:1px solid blue;*/
            content:'';
          }
          li {
            width: 100%;
            text-align: center;
            border-width: 0 0 1px;
            border-style: solid;
            border-color: $couleur-neutre-bordure;
          }
          a {
            background-image: none;
          }
        }
      }
    }
  }
}
